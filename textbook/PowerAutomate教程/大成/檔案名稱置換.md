# main

Display.SelectFileDialog.SelectFile Title: $'''選擇要更名的檔案''' InitialDirectory: $'''C:\\''' IsTopMost: False CheckIfFileExists: False SelectedFile=> SelectedFile
File.GetPathPart File: SelectedFile FileNameWithoutExtension=> FileNameNoExtension
CALL 取得文件流水號 檔名流水號=> 檔名流水號
CALL 取得版本碼 版本流水號=> 版本流水號
SET 新檔案名稱 TO $'''TC-4-{ORIGINAL}{SERIAL}-({VERSION})'''
Text.Replace Text: 新檔案名稱 TextToFind: $'''{ORIGINAL}''' IsRegEx: False IgnoreCase: False ReplaceWith: FileNameNoExtension ActivateEscapeSequences: False Result=> 新檔案名稱
Text.Replace Text: 新檔案名稱 TextToFind: $'''{SERIAL}''' IsRegEx: False IgnoreCase: False ReplaceWith: 檔名流水號 ActivateEscapeSequences: False Result=> 新檔案名稱
Text.Replace Text: 新檔案名稱 TextToFind: $'''{VERSION}''' IsRegEx: False IgnoreCase: False ReplaceWith: 檔名流水號 ActivateEscapeSequences: False Result=> 新檔案名稱
File.RenameFiles.Rename Files: SelectedFile NewName: 新檔案名稱 KeepExtension: True IfFileExists: File.IfExists.DoNothing RenamedFiles=> RenamedFiles

# 取得版本碼

IF (Folder.IfFolderExists.DoesNotExist Path: $'''C:\\PowerAutomateDesktop檔案管理''') THEN
    Folder.Create FolderPath: $'''C:\\''' FolderName: $'''PowerAutomateDesktop檔案管理''' Folder=> NewFolder
END
IF (File.IfFile.DoesNotExist File: $'''C:\\PowerAutomateDesktop檔案管理\\版本計數.txt''') THEN
    File.WriteText File: $'''C:\\PowerAutomateDesktop檔案管理\\版本計數.txt''' TextToWrite: 1 AppendNewLine: False IfFileExists: File.IfFileExists.Overwrite Encoding: File.FileEncoding.Unicode
END
File.ReadTextFromFile.ReadText File: $'''C:\\PowerAutomateDesktop檔案管理\\版本計數.txt''' Encoding: File.TextFileEncoding.UTF8 Content=> 版本數
SET 版本流水號 TO 版本數
Text.ToNumber Text: 版本數 Number=> 版本數字
SET 版本數字 TO 版本數字 + 1
File.WriteText File: $'''C:\\PowerAutomateDesktop檔案管理\\版本計數.txt''' TextToWrite: 版本數字 AppendNewLine: False IfFileExists: File.IfFileExists.Overwrite Encoding: File.FileEncoding.Unicode


# 取得文件流水號

IF (Folder.IfFolderExists.DoesNotExist Path: $'''C:\\PowerAutomateDesktop檔案管理''') THEN
    Folder.Create FolderPath: $'''C:\\''' FolderName: $'''PowerAutomateDesktop檔案管理''' Folder=> NewFolder
END
IF (File.IfFile.DoesNotExist File: $'''C:\\PowerAutomateDesktop檔案管理\\檔名計數.txt''') THEN
    File.WriteText File: $'''C:\\PowerAutomateDesktop檔案管理\\檔名計數.txt''' TextToWrite: 1 AppendNewLine: False IfFileExists: File.IfFileExists.Overwrite Encoding: File.FileEncoding.Unicode
END
File.ReadTextFromFile.ReadText File: $'''C:\\PowerAutomateDesktop檔案管理\\檔名計數.txt''' Encoding: File.TextFileEncoding.UTF8 Content=> 檔名數
SET 檔名流水號 TO 檔名數
Text.ToNumber Text: 檔名數 Number=> 檔名數字
SET 檔名數字 TO 檔名數字 + 1
File.WriteText File: $'''C:\\PowerAutomateDesktop檔案管理\\檔名計數.txt''' TextToWrite: 檔名數字 AppendNewLine: False IfFileExists: File.IfFileExists.Overwrite Encoding: File.FileEncoding.Unicode


